import{_ as V,a as n,g as $,h as P,c as i,i as z,b as s,d as k,t as d,F as y,j as f,w as A,o as l,k as F,n as H}from"./index-Mo_pLZJU.js";import{N as L}from"./NavBar-CTnWawuH.js";import{B as T}from"./BookCard-ChjQ2ZDs.js";import{b as w,c as j}from"./index-C45fDmSP.js";const D={class:"home"},E={class:"content"},I={class:"hero-card"},q={class:"stats-row"},G={class:"stat-item"},J={class:"stat-value headline-medium"},K={class:"stat-item"},O={class:"stat-value headline-medium"},Q={class:"stat-item"},R={class:"stat-value headline-medium"},U={key:0,class:"book-grid"},W={key:1,class:"empty-state"},X={key:2,class:"pagination"},Y=["disabled"],Z={class:"page-numbers"},ss=["onClick"],ts={class:"page-info body-medium"},os=["disabled"],es={class:"md-dialog borrow-dialog"},as={class:"md-dialog-content"},ls={class:"book-preview"},is={class:"preview-cover"},ns=["src"],ds={key:1},cs={class:"preview-info"},rs={class:"title-medium"},us={class:"body-medium"},vs={class:"md-dialog-actions"},ms={__name:"HomeView",setup(_s){const p=n([]),v=n({total_books:0,total_categories:0,total_authors:0}),b=n(""),a=n(1),B=n(12),g=n(0),c=n(1),u=n(!1),r=n(null),C=$(()=>{const o=[],t=Math.max(1,a.value-2),e=Math.min(c.value,a.value+2);for(let _=t;_<=e;_++)o.push(_);return o}),S=o=>{b.value=o,a.value=1,m()},h=o=>{o>=1&&o<=c.value&&(a.value=o,m(),window.scrollTo({top:0,behavior:"smooth"}))},x=o=>{r.value=o,u.value=!0},M=async()=>{try{await j.borrow(r.value.id),alert("å€Ÿé˜…æˆåŠŸï¼"),u.value=!1,m()}catch(o){alert(o.detail||"å€Ÿé˜…å¤±è´¥")}},m=async()=>{try{const o={page:a.value,page_size:B.value};b.value&&(o.search=b.value);const t=await w.getList(o);p.value=t.items,g.value=t.total,c.value=t.total_pages}catch(o){console.error("åŠ è½½å›¾ä¹¦å¤±è´¥",o)}},N=async()=>{try{v.value=await w.getStats()}catch(o){console.error("åŠ è½½ç»Ÿè®¡å¤±è´¥",o)}};return P(()=>{m(),N()}),(o,t)=>(l(),i("div",D,[z(L,{onSearch:S}),s("div",E,[s("div",I,[t[7]||(t[7]=s("div",{class:"hero-content"},[s("h1",{class:"display-small"},"ğŸ“š æ¬¢è¿æ¥åˆ°å›¾ä¹¦é¦†"),s("p",{class:"body-large"},"å‘ç°çŸ¥è¯†çš„æµ·æ´‹ï¼Œå¼€å¯é˜…è¯»ä¹‹æ—…")],-1)),s("div",q,[s("div",G,[s("span",J,d(v.value.total_books),1),t[4]||(t[4]=s("span",{class:"stat-label body-small"},"é¦†è—å›¾ä¹¦",-1))]),s("div",K,[s("span",O,d(v.value.total_categories),1),t[5]||(t[5]=s("span",{class:"stat-label body-small"},"å›¾ä¹¦åˆ†ç±»",-1))]),s("div",Q,[s("span",R,d(v.value.total_authors),1),t[6]||(t[6]=s("span",{class:"stat-label body-small"},"ç­¾çº¦ä½œè€…",-1))])])]),t[9]||(t[9]=s("h2",{class:"title-large section-title"},"ğŸ“– æœ€æ–°ä¸Šæ¶",-1)),p.value.length>0?(l(),i("div",U,[(l(!0),i(y,null,f(p.value,e=>(l(),F(T,{key:e.id,book:e,onBorrow:x},null,8,["book"]))),128))])):(l(),i("div",W,[...t[8]||(t[8]=[s("div",{class:"empty-icon"},"ğŸ“–",-1),s("p",{class:"title-medium"},"æš‚æ— å›¾ä¹¦æ•°æ®",-1),s("p",{class:"body-medium"},"è¯·ç¨åå†æ¥æŸ¥çœ‹",-1)])])),c.value>1?(l(),i("div",X,[s("button",{class:"page-btn md-tonal-button",disabled:a.value===1,onClick:t[0]||(t[0]=e=>h(a.value-1))}," ä¸Šä¸€é¡µ ",8,Y),s("div",Z,[(l(!0),i(y,null,f(C.value,e=>(l(),i("button",{key:e,class:H(["page-num",{active:e===a.value}]),onClick:_=>h(e)},d(e),11,ss))),128))]),s("span",ts," ç¬¬ "+d(a.value)+" / "+d(c.value)+" é¡µï¼Œå…± "+d(g.value)+" æœ¬ ",1),s("button",{class:"page-btn md-tonal-button",disabled:a.value===c.value,onClick:t[1]||(t[1]=e=>h(a.value+1))}," ä¸‹ä¸€é¡µ ",8,os)])):k("",!0)]),u.value?(l(),i("div",{key:0,class:"md-dialog-scrim",onClick:t[3]||(t[3]=A(e=>u.value=!1,["self"]))},[s("div",es,[t[11]||(t[11]=s("h3",{class:"md-dialog-title"},"ç¡®è®¤å€Ÿé˜…",-1)),s("div",as,[s("div",ls,[s("div",is,[r.value?.cover?(l(),i("img",{key:0,src:r.value.cover},null,8,ns)):(l(),i("span",ds,"ğŸ“–"))]),s("div",cs,[s("p",rs,d(r.value?.title),1),s("p",us,d(r.value?.author),1)])]),t[10]||(t[10]=s("div",{class:"borrow-info"},[s("span",{class:"label-medium"},"å€Ÿé˜…æœŸé™"),s("span",{class:"body-medium"},"30å¤©")],-1))]),s("div",vs,[s("button",{class:"md-text-button",onClick:t[2]||(t[2]=e=>u.value=!1)},"å–æ¶ˆ"),s("button",{class:"md-filled-button",onClick:M},"ç¡®è®¤å€Ÿé˜…")])])])):k("",!0)]))}},ks=V(ms,[["__scopeId","data-v-d3a800e9"]]);export{ks as default};
