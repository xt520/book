import{_ as x,a as c,h as V,c as l,i as N,b as t,d as v,F as p,j as k,t as r,w as $,o as a,k as I}from"./index-Mo_pLZJU.js";import{N as L}from"./NavBar-CTnWawuH.js";import{B as M}from"./BookCard-ChjQ2ZDs.js";import{b as g,c as S}from"./index-C45fDmSP.js";const z={class:"category-page"},A={class:"content"},F={key:0,class:"category-grid"},j=["onClick"],D={class:"category-icon"},E={class:"category-name title-medium"},q={class:"category-count body-small"},G={key:1,class:"category-books"},H={class:"section-header"},J={class:"title-large"},K={class:"body-medium"},O={key:0,class:"book-grid"},P={key:1,class:"empty-state"},Q={class:"md-dialog"},R={class:"md-dialog-content"},T={class:"md-dialog-actions"},U={__name:"CategoryView",setup(W){const y=c([]),n=c(null),d=c([]),i=c(!1),u=c(null),b={ç¼–ç¨‹:"ğŸ’»",æ–‡å­¦:"ğŸ“–",ç§‘æŠ€:"ğŸ”¬",è‰ºæœ¯:"ğŸ¨",ç§‘å¹»:"ğŸš€",å†å²:"ğŸ“œ",ç»æµ:"ğŸ“Š",å…¶å®ƒ:"ğŸ“š"},h=o=>b[o]||"ğŸ“š",f=o=>{},_=async o=>{n.value=o;try{const e=await g.getList({category:o,page_size:100});d.value=e.items}catch(e){console.error("åŠ è½½åˆ†ç±»å›¾ä¹¦å¤±è´¥",e)}},w=o=>{u.value=o,i.value=!0},C=async()=>{try{await S.borrow(u.value.id),alert("å€Ÿé˜…æˆåŠŸï¼"),i.value=!1,_(n.value)}catch(o){alert(o.detail||"å€Ÿé˜…å¤±è´¥")}};return V(async()=>{try{const o=await g.getCategories(),s=(await g.getList({page_size:100})).items;y.value=o.map(m=>({name:m,count:s.filter(B=>B.category===m).length}))}catch(o){console.error("åŠ è½½åˆ†ç±»å¤±è´¥",o)}}),(o,e)=>(a(),l("div",z,[N(L,{onSearch:f}),t("div",A,[e[4]||(e[4]=t("h1",{class:"headline-medium page-title"},"ğŸ“‚ å›¾ä¹¦åˆ†ç±»",-1)),n.value?v("",!0):(a(),l("div",F,[(a(!0),l(p,null,k(y.value,s=>(a(),l("div",{key:s.name,class:"category-card md-card-elevated",onClick:m=>_(s.name)},[t("div",D,r(h(s.name)),1),t("div",E,r(s.name),1),t("div",q,r(s.count)+" æœ¬å›¾ä¹¦",1)],8,j))),128))])),n.value?(a(),l("div",G,[t("div",H,[t("button",{class:"md-text-button back-btn",onClick:e[0]||(e[0]=s=>n.value=null)}," â† è¿”å›åˆ†ç±» "),t("h2",J,r(n.value),1),t("span",K,r(d.value.length)+" æœ¬å›¾ä¹¦",1)]),d.value.length>0?(a(),l("div",O,[(a(!0),l(p,null,k(d.value,s=>(a(),I(M,{key:s.id,book:s,onBorrow:w},null,8,["book"]))),128))])):(a(),l("div",P,[...e[3]||(e[3]=[t("span",{class:"empty-icon"},"ğŸ“­",-1),t("p",{class:"body-medium"},"è¯¥åˆ†ç±»æš‚æ— å›¾ä¹¦",-1)])]))])):v("",!0)]),i.value?(a(),l("div",{key:0,class:"md-dialog-scrim",onClick:e[2]||(e[2]=$(s=>i.value=!1,["self"]))},[t("div",Q,[e[6]||(e[6]=t("h3",{class:"md-dialog-title"},"ç¡®è®¤å€Ÿé˜…",-1)),t("div",R,[t("p",null,"æ‚¨è¦å€Ÿé˜…ã€Š"+r(u.value?.title)+"ã€‹å—ï¼Ÿ",1),e[5]||(e[5]=t("p",{class:"body-small",style:{"margin-top":"8px",color:"var(--md-outline)"}},"å€Ÿé˜…æœŸé™ï¼š30å¤©",-1))]),t("div",T,[t("button",{class:"md-text-button",onClick:e[1]||(e[1]=s=>i.value=!1)},"å–æ¶ˆ"),t("button",{class:"md-filled-button",onClick:C},"ç¡®è®¤å€Ÿé˜…")])])])):v("",!0)]))}},oe=x(U,[["__scopeId","data-v-c8fa53b8"]]);export{oe as default};
